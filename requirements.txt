# migrate_add_approved.py — run once, then delete
from app import app, db
with app.app_context():
    # Inspect columns
    info = db.session.execute("PRAGMA table_info(user);").fetchall()
    cols = [row[1] for row in info]   # row[1] is column name
    print("Existing columns:", cols)

    if 'approved' in cols:
        print("Column 'approved' already exists — nothing to do.")
    else:
        print("Adding 'approved' column (INTEGER DEFAULT 0)...")
        db.session.execute("ALTER TABLE user ADD COLUMN approved INTEGER NOT NULL DEFAULT 0;")
        db.session.commit()
        print("✅ Done. 'approved' column added.")
